<!DOCTYPE html>  
<!--[if IE 7]>
<html class="ie ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html class="ie ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 7) | !(IE 8)  ]><!-->
<html lang="en-US">
<!--<![endif]-->

<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width"/>
    <title>OPENi | a European Union ICT Project</title>
    <link rel="profile" href="http://gmpg.org/xfn/11"/>
    <link rel="pingback" href="xmlrpc.php"/>
    <link rel="shortcut icon" href="/wp-content/themes/openi/favicon.ico"/>
    <!--[if lt IE 9]>
    <script src="/wp-content/themes/openi/js/html5.js" type="text/javascript"></script>
    <![endif]-->
    <link rel="alternate" type="application/rss+xml" title="OPENi &raquo; Feed" href="feed/index.html"/>
    <link rel="alternate" type="application/rss+xml" title="OPENi &raquo; Comments Feed"
          href="comments/feed/index.html"/>

    <script type="text/javascript">
        //<![CDATA[
        // Google Analytics for WordPress by Yoast v4.2.8 | http://yoast.com/wordpress/google-analytics/
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-37594867-1']);
        _gaq.push(['_trackPageview']);
        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
        //]]></script>
    <link rel='stylesheet' id='cptchStylesheet-css' href='/wp-content/plugins/captcha/css/style1bba.css?ver=3.5'
          type='text/css' media='all'/>
    <link rel='stylesheet' id='contact-form-7-css'
          href='/wp-content/plugins/contact-form-7/includes/css/stylesd617.css?ver=3.3.2' type='text/css' media='all'/>
    <link rel='stylesheet' id='twentytwelve-fonts-css'
          href='https://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700&amp;subset=latin,latin-ext'
          type='text/css' media='all'/>
    <link rel='stylesheet' id='twentytwelve-style-css' href='/wp-content/themes/openi/style1bba.css?ver=3.5'
          type='text/css' media='all'/>
    <!--[if lt IE 9]>
    <link rel='stylesheet' id='twentytwelve-ie-css'
          href='/wp-content/themes/openi/css/ie.css?ver=20121010' type='text/css' media='all'/>
    <![endif]-->
    <link rel='stylesheet' id='flex-style-css' href='/wp-content/themes/openi/inc/slider/css/flexslider1bba.css?ver=3.5'
          type='text/css' media='all'/>
    <link rel='stylesheet' id='easy_table_style-css'
          href='/wp-content/plugins/easy-table/themes/default/style492f.css?ver=0.9' type='text/css' media='all'/>
    <script type="text/javascript" src="https://code.jquery.com/jquery-1.11.0.min.js"></script>
    <!--script type='text/javascript' src='/wp-includes/js/jquery/jquery4511.js?ver=1.8.3'></script-->
    <link rel="EditURI" type="application/rsd+xml" title="RSD" href="xmlrpc0db0.php?rsd"/>
    <link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml"/>
    <link rel='next' title='News' href='news/index.html'/>
    <meta name="generator" content="WordPress 3.5"/>
    <link rel='canonical' href='index.html'/>

    <script type="text/javascript" charset="utf-8">
        jQuery(window).load(function () {
            jQuery('.flexslider').flexslider({
                animation: "fade",
                direction: "horizontal",
                slideshowSpeed: 7000,
                animationSpeed: 600,
                controlNav: true,
                directionNav: true,
                prevText: "Previous",
                nextText: "Next"
            });
        });
    </script>


    <link rel='stylesheet' href='tutorial_style.css' type='text/css' media='all'/>

</head>

<body class="home page page-id-4 page-template-default custom-font-enabled">
<div id="page" class="hfeed site">
<header id="masthead" class="site-header" role="banner">
    <div id="headergroup"  style="width: 700px;">
        <hgroup>
            <h1 class="site-title"><a href="/" title="OPENi"
                                      rel="home">OPENi</a></h1>
            <!--<h2 class="site-description"></h2>-->
        </hgroup>
        <nav id="site-navigation" class="main-navigation" role="navigation">
            <h3 class="menu-toggle">Menu</h3>
            <a class="assistive-text" href="#content" title="Skip to content">Skip to content</a>

        </nav>
    </div>
</header>

<div id="main" class="wrapper" style="width: 700px;">

    <h1 id="notifications-and-subscriptions">Notifications and Subscriptions</h1>
<hr>
<h3 id="server-sent-events">Server-Sent Events</h3>
<p>In order to complete this tutorial two objects are required.</p>
<p>Create each objects within the same Cloudlet.
Record both the objectID and the CloudletID for each.
Using these 2 objects we will create 2 SSE notifications, one object based and one cloudlet based.</p>
<p>The first is a subscription that focuses on a single object within a cloudlet, if this object is changed then a notification is triggered. Note that the object type must be included when creating the notifications.</p>
<p><strong>N.B.</strong> Place your recorded IDs into the JSON below.</p>
<pre><code class="lang-json">{
    "<span class="hljs-attribute">cloudletid</span>"       : <span class="hljs-value">[CloudletID]</span>,
    "<span class="hljs-attribute">typeid</span>"           : <span class="hljs-value">[OPENiTypeID]</span>,
    "<span class="hljs-attribute">objectid</span>"         : <span class="hljs-value">[ObjectID]</span>,
    "<span class="hljs-attribute">notification_type</span>": <span class="hljs-value"><span class="hljs-string">"SSE"</span>
</span>}
</code></pre>
<p>This second subscription is a cloudlet level subscription. If an object of the selected OPENi type within this cloudlet is changed a notification will be sent out.</p>
<pre><code class="lang-json">{
    "<span class="hljs-attribute">cloudletid</span>"       : <span class="hljs-value">[CloudletID]</span>,
    "<span class="hljs-attribute">typeid</span>"           : <span class="hljs-value">[OPENiTypeID]</span>,
    "<span class="hljs-attribute">notification_type</span>": <span class="hljs-value"><span class="hljs-string">"SSE"</span>
</span>}
</code></pre>
<p>Using the Cloudlet API UI create these subscriptions and record the IDs returned.</p>
<p>Once the Subscriptions are created we can see the notifications in action. The OPENi example page is included in the mongrel2 git project. The url path for the example page is <strong>/sse.html</strong></p>
<p>This path alone will not show you any notifications, the page needs a url parameter to accomplish this.</p>
<p>The url parameter is <strong>?sse=</strong> and may look something like this:</p>
<ul>
<li><em>/sse.html?sse=s_subs1-134+s_subs2-166</em></li>
</ul>
<p>The url can take multiple subscription IDs separated by a &quot;+&quot;.</p>
<hr>
<h3 id="google-cloud-messaging">Google Cloud Messaging</h3>
<p>Subscription for Google Cloud Messaging follow a similar pattern to the previous subscriptions. It allows both object level or cloudlet level subscriptions.</p>
<pre><code class="lang-json">{
    "<span class="hljs-attribute">cloudletid</span>"       : <span class="hljs-value">[CloudletID]</span>,
    "<span class="hljs-attribute">typeid</span>"           : <span class="hljs-value">[OPENiTypeID]</span>,
    "<span class="hljs-attribute">objectid</span>"         : <span class="hljs-value">[ObjectID]</span>,
    "<span class="hljs-attribute">notification_type</span>": <span class="hljs-value"><span class="hljs-string">"GCM"</span></span>,
    "<span class="hljs-attribute">endpoint</span>"         : <span class="hljs-value">[Android Device Registration ID]
</span>}
</code></pre>
<p>The Platform will send a GCM notification to the Android Device endpoint when it detects a change in the cloudlet that requires a notification.</p>

</div>

</body></html>